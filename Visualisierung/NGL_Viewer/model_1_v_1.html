<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>NGL Distanz zwischen zwei Punkten</title>
  <style>
    body { margin: 0; font-family: sans-serif; background: #111; color: white; }
    #viewport { width: 100vw; height: 90vh; }
    #controls { text-align: center; margin-top: 10px; }
  </style>
  <!-- NGL.js -->
  <script src="./ngl.js"></script>
</head>
<body>
  <div id="viewport"></div>
  <div id="controls">
    <label>Distanz: <input type="range" id="distance" min="1" max="100" step="0.1" value="5"></label>
    <span id="value">5.0</span>
  </div>

  <script>
    // === NGL Stage ===
    const stage = new NGL.Stage("viewport", { backgroundColor: "black" });
    window.addEventListener("resize", () => stage.handleResize(), false);

    // === Zwei Punkte im Raum ===
    let d = 5.0;
    const pointA = [0, 0, 0];
    let pointB = [d, 0, 0];

    // === Shape-Objekt erzeugen ===
    let shape = new NGL.Shape("PunkteUndLinie");

    // Punkte hinzufügen
    shape.addSphere(pointA, [1, 0, 0], 0.3); // rot
    shape.addSphere(pointB, [0, 1, 0], 0.3); // grün

    // Linie (hier simulieren wir "gestrichelt" durch kurze Segmente)
    function addDashedLine(a, b, color, segments = 10) {
      const dir = [b[0] - a[0], b[1] - a[1], b[2] - a[2]];
      for (let i = 0; i < segments; i += 2) {
        const t1 = i / segments;
        const t2 = (i + 1) / segments;
        const p1 = [a[0] + dir[0]*t1, a[1] + dir[1]*t1, a[2] + dir[2]*t1];
        const p2 = [a[0] + dir[0]*t2, a[1] + dir[1]*t2, a[2] + dir[2]*t2];
        shape.addCylinder(p1, p2, color, 0.05);
      }
    }

    addDashedLine(pointA, pointB, [1, 1, 1]);

    // === Darstellung laden ===
    let comp = stage.addComponentFromObject(shape);
    comp.addRepresentation("buffer");
    stage.autoView();

    // === Slider-Interaktion ===
    const slider = document.getElementById("distance");
    const valueLabel = document.getElementById("value");

    slider.addEventListener("input", () => {
      d = parseFloat(slider.value);
      valueLabel.textContent = d.toFixed(1);
      pointB = [d, 0, 0];

      // Alte Darstellung entfernen
      shape.dispose();
      if (comp) comp.dispose();
      
      shape.addSphere(pointA, [1, 0, 0], 0.3);
      shape.addSphere(pointB, [0, 1, 0], 0.3);
      addDashedLine(pointA, pointB, [1, 1, 1]);

      comp = stage.addComponentFromObject(shape);
      comp.addRepresentation("buffer");
      stage.autoView();
    });
  </script>
</body>
</html>
