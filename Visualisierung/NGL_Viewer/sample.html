<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>NGL Test – Atome um Retinal</title>
  <script src="https://unpkg.com/ngl@latest/dist/ngl.js"></script>
  <style>
    body { margin: 0; overflow: hidden; background: #000; }
    #viewport { width: 100vw; height: 100vh; }
  </style>
</head>
<body>
  <div id="viewport"></div>

  <script>
    // Bühne initialisieren
    const stage = new NGL.Stage("viewport", { backgroundColor: "black" });

    // Datei von RCSB laden
    stage.loadFile("rcsb://1kzk").then(function (o) {

      // 1️⃣ Auswahl des Liganden (Retinal)
      const selection = new NGL.Selection("ligand");
      const radius = 5;

      // 2️⃣ Atome innerhalb von 5 Å um Retinal finden
      const atomSet = o.structure.getAtomSetWithinSelection(selection, radius);

      // 3️⃣ Auf komplette Reste erweitern
      const atomSet2 = o.structure.getAtomSetWithinGroup(atomSet);

      // 4️⃣ Darstellungen hinzufügen
      o.addRepresentation("cartoon", { colorScheme: "residueindex" });
      o.addRepresentation("ball+stick", { sele: atomSet2.toSeleString() + " and (not _H)", colorScheme: "element" });
       o.addRepresentation("ball+stick", { sele: atomSet2.toSeleString() + " and (not _H)", colorScheme: "element" });

      // 5️⃣ Automatisch zoomen
      o.autoView();
    });

    // Resizing
    window.addEventListener("resize", () => stage.handleResize());
  </script>
</body>
</html>
