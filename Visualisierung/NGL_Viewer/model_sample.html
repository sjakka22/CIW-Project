<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>NGL Interaktionsmodelle</title>
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      background: #111;
      color: white;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 30px;
      padding-bottom: 50px;
    }
    .model {
      border: 1px solid #333;
      border-radius: 8px;
      box-shadow: 0 0 8px #222;
      width: 90%;
      max-width: 1000px;
      background: #181818;
      padding: 10px;
    }
    .viewport {
      width: 100%;
      height: 60vh;
    }
    .controls {
      text-align: center;
      margin-top: 10px;
    }
    input[type=range] { width: 200px; }
    label { margin: 0 10px; display: inline-block; width: 80px; text-align: right; }
    h2 { text-align: center; color: #ddd; }
  </style>
  <script src="./ngl.js"></script>
</head>
<body>

  <!-- Modell 1-1 -->
  <div class="model" id="model1_1">
    <h2>Modell 1 – 1 Interaktion</h2>
    <div id="viewport_1_1" class="viewport"></div>
    <div class="controls">
      <label>Distanz:</label>
      <input type="range" id="distance_1_1" min="1" max="100" step="0.1" value="5">
      <span id="value_1_1">5.0</span>
    </div>
  </div>

  <!-- Modell 1-2 -->
  <div class="model" id="model1_2">
    <h2>Modell 1 – 2 Interaktion</h2>
    <div id="viewport_1_2" class="viewport"></div>
    <div class="controls">
      <div>
        <label>d_AB</label>
        <input type="range" id="dAB_1_2" min="1" max="10" step="0.1" value="4">
        <span id="valAB_1_2">4.0</span>
      </div>
      <div>
        <label>d_AC</label>
        <input type="range" id="dAC_1_2" min="1" max="10" step="0.1" value="3">
        <span id="valAC_1_2">3.0</span>
      </div>
      <div>
        <label>Winkel</label>
        <input type="range" id="angle_1_2" min="10" max="170" step="1" value="60">
        <span id="valAngle_1_2">60°</span>
      </div>
    </div>
  </div>

  <script>
    // === Modell 1-1 ===
    const stage1_1 = new NGL.Stage("viewport_1_1", { backgroundColor: "black" });
    window.addEventListener("resize", () => stage1_1.handleResize(), false);

    let d1 = 5.0;
    const A1 = [0, 0, 0];
    let B1 = [d1, 0, 0];

    let shape1_1 = new NGL.Shape("model_1_1");
    function addDashedLine(a, b, color, segments = 10) {
      const dir = [b[0] - a[0], b[1] - a[1], b[2] - a[2]];
      for (let i = 0; i < segments; i += 2) {
        const t1 = i / segments;
        const t2 = (i + 1) / segments;
        const p1 = [a[0] + dir[0]*t1, a[1] + dir[1]*t1, a[2] + dir[2]*t1];
        const p2 = [a[0] + dir[0]*t2, a[1] + dir[1]*t2, a[2] + dir[2]*t2];
        shape1_1.addCylinder(p1, p2, color, 0.05);
      }
    }

    shape1_1.addSphere(A1, [1, 0, 0], 0.3);
    shape1_1.addSphere(B1, [0, 1, 0], 0.3);
    addDashedLine(A1, B1, [1, 1, 1]);

    let comp1_1 = stage1_1.addComponentFromObject(shape1_1);
    comp1_1.addRepresentation("buffer");
    stage1_1.autoView();

    const s1 = document.getElementById("distance_1_1");
    const val1 = document.getElementById("value_1_1");

    s1.addEventListener("input", () => {
      d1 = parseFloat(s1.value);
      val1.textContent = d1.toFixed(1);
      B1 = [d1, 0, 0];
      shape1_1.dispose();
      comp1_1.dispose();
      shape1_1 = new NGL.Shape("model_1_1");
      shape1_1.addSphere(A1, [1,0,0], 0.3);
      shape1_1.addSphere(B1, [0,1,0], 0.3);
      addDashedLine(A1, B1, [1,1,1]);
      comp1_1 = stage1_1.addComponentFromObject(shape1_1);
      comp1_1.addRepresentation("buffer");
      stage1_1.autoView();
    });

    // === Modell 1-2 ===
    const stage1_2 = new NGL.Stage("viewport_1_2", { backgroundColor: "black" });
    window.addEventListener("resize", () => stage1_2.handleResize(), false);

    let dAB = 4.0, dAC = 3.0, angleA = 60.0;
    const A = [0, 0, 0];
    let B, C;
    let shape1_2, comp1_2;

    function updateGeometry1_2() {
      const rad = angleA * Math.PI / 180;
      B = [dAB, 0, 0];
      C = [dAC * Math.cos(rad), dAC * Math.sin(rad), 0];
      if (shape1_2) shape1_2.dispose();
      if (comp1_2) comp1_2.dispose();

      shape1_2 = new NGL.Shape("model_1_2");
      shape1_2.addSphere(A, [1, 0, 0], 0.3, "A");
      shape1_2.addSphere(B, [0, 1, 0], 0.3, "B");
      shape1_2.addSphere(C, [0, 0, 1], 0.3, "C");
      shape1_2.addCylinder(A, B, [1, 1, 0], 0.05, "A–B");
      shape1_2.addCylinder(A, C, [1, 1, 0], 0.05, "A–C");
      shape1_2.addCylinder(B, C, [1, 1, 1], 0.05, "B–C");
      shape1_2.addText([A[0], A[1]+0.7, A[2]], [1,1,0], 0.6, `${angleA.toFixed(1)}°`);

      comp1_2 = stage1_2.addComponentFromObject(shape1_2);
      comp1_2.addRepresentation("buffer");
      stage1_2.autoView();
    }
    updateGeometry1_2();

    const sAB = document.getElementById("dAB_1_2");
    const sAC = document.getElementById("dAC_1_2");
    const sAng = document.getElementById("angle_1_2");
    const vAB = document.getElementById("valAB_1_2");
    const vAC = document.getElementById("valAC_1_2");
    const vAng = document.getElementById("valAngle_1_2");

    function onChange1_2() {
      dAB = parseFloat(sAB.value);
      dAC = parseFloat(sAC.value);
      angleA = parseFloat(sAng.value);
      vAB.textContent = dAB.toFixed(1);
      vAC.textContent = dAC.toFixed(1);
      vAng.textContent = `${angleA.toFixed(0)}°`;
      updateGeometry1_2();
    }
    sAB.addEventListener("input", onChange1_2);
    sAC.addEventListener("input", onChange1_2);
    sAng.addEventListener("input", onChange1_2);
  </script>
</body>
</html>
